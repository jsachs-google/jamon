<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--    $Id$ -->
<html>
  <head>
    <title>Jamon User's Guide</title>
    <link rel="StyleSheet" href="base.css" type="text/css" media="screen" />
  </head>

  <body>
    <h1>Jamon User's Guide</h1>

    <h2>Invoking templates from Java</h2>

    <ol>
      <li>
        First, make sure you have preprocessed the top-level templates
        into their Java equivalents.
      </li>
      <li>
        When building your project, be sure to include the generated
        source files in the build process.
      </li>
      <li>
        Create a TemplateManager instance (e.g. the
        StandardTemplateManager), and configure it appropriately
      </li>
      <li>
        Create an instance of the template, call
        <code>writeTo()</code> with a <code>Writer</code>, set any
        optional arguments, and invoke its render method.
      </li>
    </ol>
    <h4>Example</h4>

    Suppose the template in
    <code>templates/org/modusponens/templates/Foo</code> contains

    <pre class="template">
&lt;%args&gt;
  int count;
  String name => "Somebody";
  String greeting;
&lt;/%args&gt;
&lt;html&gt;
  &lt;body&gt;
%   for (int i = 1; i &lt;= count; ++i) {
    &lt;% i %&gt;. &lt;% greeting %&gt; &lt;% name %&gt; &lt;br /&gt;
%   }
  &lt;/body&gt;
&lt;/html&gt;
</pre>
    This can be processed into a Java interface with the
    Jamon <code>TemplateProcessor</code> class, e.g.
  <pre class="tty">
java org.jamon.TemplateProcessor \
     --destDir=./gensrc \
     --sourceDir=templates \
     templates/org/modusponens/templates/Foo
</pre>
which will place the generated Java source file(s) into the
<code>gensrc</code> directory.
<p>
You can then use the template as follows:
        <pre class="code">
import org.modusponens.templates.Foo;
import org.jamon.TemplateManager;

  ...
       StandardTemplateManager templateManager =
         new StandardTemplateManager(...);
       // to be able to dynamically recompile templates:
       //    templateManager.setSourceDir("templates");
       //    templateManager.setWorkDir("jamonwork");
       ...
       Writer writer = new OutputStreamWriter(System.out);
       new Foo(templateManager)
         .writeTo(writer)
         .setName("Duke & Co.")
         .render(3, "Hello");
</pre>
    <p>
      When you build your project, be sure to include the java files
      in the <code>gensrc</code> directory in the compilation command.
    <p>
      Execution of the above code snippet produces the output
    <pre class="tty">
&lt;html&gt;
  &lt;body&gt;
    1. Hello Duke &amp;amp; Co.&lt;br /&gt;
    2. Hello Duke &amp;amp; Co.&lt;br /&gt;
    3. Hello Duke &amp;amp; Co.&lt;br /&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>

<h3>Changing the default escaping mechanism</h3>
Suppose the we wanted to include some text for inclusion in an email.  Since we are 
producing plain text (and not HTML) we want a different default escaping mechanism.
For example
    <pre class="template">
&lt;%args&gt;
  int count;
  String name => "Somebody";
  String greeting;
&lt;/%args&gt;
    Many Greetings
    ==============
%   for (int i = 1; i &lt;= count; ++i) {
    &lt;% i %&gt;. &lt;% greeting %&gt; &lt;% name %&gt;
%   }
 </pre>
Could be called from Java as follows
        <pre class="code">
import org.modusponens.templates.Foo;
import org.jamon.TemplateManager;
<b>import org.jamon.Encoding;</b>

  ...
       StandardTemplateManager templateManager =
         new StandardTemplateManager(...);
       // to be able to dynamically recompile templates:
       //    templateManager.setSourceDir("templates");
       //    templateManager.setWorkDir("jamonwork");
       ...
       Writer writer = new OutputStreamWriter(System.out);
       new Foo(templateManager)
         .writeTo(writer)
         <b>.encoding(Encoding.NONE)</b>
         .setName("Duke & Co.")
         .render(3, "Hello");
</pre>
(Note how we set the escaping mechanism.)  It would emit
    <pre class="tty">
    Many Greetings
    ==============
    1. Hello Duke &amp; Co.
    2. Hello Duke &amp; Co.
    3. Hello Duke &amp; Co.
</pre>

  </body>
</html>
